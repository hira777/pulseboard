# 機能一覧（Pulseboard 概要）

本ページは変更頻度の高い「機能カタログ」を集約します。要件詳細や業務ルールは `docs/requirements.md` を参照してください。

## 0. 記法

- タグ: `[S1]` 初期リリース最小, `[S2]` 次フェーズ以降, `[admin]` 管理者, `[member]` 一般メンバー
- テナント境界: すべての画面は `/t/:slug/...` 配下。未権限はページ=404、API/Actions=403（要件 9.1.1）

## 1. ダッシュボード

- [S1][admin|member] KPI（当日/今週の予約数、稼働率の簡易指標）
- [S1][admin|member] 最近の更新（直近 N 件）
- [S1][admin|member] ショートカット（予約作成、可用枠検索 など）

## 2. 予約管理

- [S1][admin|member] 予約の作成/変更/キャンセル/リスケ/担当者割当（ライフサイクル準拠）
- [S1][admin|member] カレンダー（週/日）と一覧（高速スクロール）表示
- [S1][admin|member] 競合検知（部屋/機材/営業時間/例外日）と理由表示（`requirements.md` 7章）
- [S1][admin|member] 内部メモ／監査ログの参照
- [S2][admin] 料金見積もり表示（ピーク/オフピーク、最低利用時間）

## 3. 可用枠検索（listAvailability）

- [S1][admin|member] 入力: 期間、サービス、部屋条件、必要機材（SKU: 数量）
- [S1] 出力: 候補スロット（n≤50、開始/終了、割当可能な部屋/機材組合せ、理由コード）
- [S1] 判定順: 営業時間 → 例外日 → 部屋重複 → 機材在庫（`stock`）→（任意）スタッフ（`requirements.md` 7章）

## 4. 機材・在庫

- [S1][admin] 機材 SKU の CRUD（個体管理切替、在庫数）
- [S1][admin|member] 予約への SKU 数量確保／返却時に個体割当
- [S2][admin] キット定義と在庫引当（セット）
- [S2][admin] 故障/修理/紛失の個体ステータス管理と除外

## 5. 部屋/サービス/スタッフ/顧客

- [S1][admin] 部屋・サービスの CRUD（営業時間/色/バッファ設定）
- [S1][admin] 例外日（ブラックアウト）の登録（店舗/部屋/機材/スタッフ）
- [S1][admin] スタッフ登録（スキル、アクティブ）
- [S1][admin|member] 顧客の基本情報登録と重複最小化

## 6. 認証・権限・監査

- [S1] Supabase JWT 認証（admin/member）
- [S1] RLS と URL テナント境界（`/t/:slug`）、未権限=404・API/Actions=403（要件 2章, 9.1.1）
- [S1] 操作ログ（監査）と相関 ID 付与、エラー規約（Idempotency / If-Match / 409）

## 7. テレメトリ / 非機能（抜粋）

- [S1] 重大イベントの限定計測（予約更新、在庫異常）
- [S1] パフォーマンス（初期バンドル ≤200KB 目標）、アクセシビリティ、型安全（TS + Zod）

---

### 付記: 受け入れとのトレーサビリティ

- `docs/requirements.md`「受け入れ基準（S1）」および `docs/roadmap.md` のフェーズにマッピング。
- E2E（Playwright）対象: 予約 CRUD／可用枠検索／ロール別アクセス。
