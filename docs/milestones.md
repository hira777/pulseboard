# 開発マイルストーン

## フェーズ計画

### フェーズ 0：セットアップ（半日）

- Next.js プロジェクト作成、TypeScript 設定
- ESLint / Prettier / Husky
- ディレクトリ構成（src/app, entities, features, shared）
- UI キット導入（shadcn/ui など）

### フェーズ 1：データ層・WebSocket 基盤（1〜2 日）

- useWebSocket Hook 実装
  - 接続 / 再接続（指数バックオフ）
  - send / subscribe
  - キュー処理（切断中に送ったイベントを後で flush）
  - ping/pong 心拍
- イベント型定義（Metrics, Orders, ChatEvent）
- Zod で runtime validate

### フェーズ 2：認証 & RBAC（1 日）

- /login ページでログイン処理
- Cookie ベースのセッション
- RBAC：
  - admin：全機能アクセス可
  - member：制限付き
- middleware で未ログインリダイレクト

### フェーズ 3：ダッシュボード（2 日）

- KPI カード（注文数 / 売上 / エラー率 / その他）
- ライブイベントフィード（仮想リスト）
- 接続状態表示（接続中 / 切断 / リトライ中）
- 通知（Toast）

### フェーズ 4：大規模テーブル（2〜3 日）

- 注文一覧（5〜10 万件, 6〜10 列）
- サーバ側ページング / ソート / フィルタ
- 検索（全文 / 前方一致）
- 仮想スクロール 60fps

### フェーズ 5：チャット（2〜3 日）

- 単一ルームチャット
- presence（誰が入室しているか）
- typing インジケータ
- メッセージ送信（楽観的更新 →ACK）
- 既読/未読管理
- オフライン送信キュー

### フェーズ 6：仕上げ（1〜2 日）

- パフォーマンス計測（Lighthouse）
- コード分割 / 画像最適化 / Memo 化
- A11y チェック（キーボード操作/aria）
- E2E テスト（送信 →ACK→ 未読クリア）

---

## 受け入れ基準（チェックリスト）

- 回線切断 → 再接続でデータが欠損なく復元される
- 10 万件テーブルで 60fps スクロール
- チャット送信は即描画、失敗時は自動復旧/再送
- 主要操作はキーボードのみで完了
- LCP/CLS/INP 目標達成、バンドル 200KB 以内
- admin と member の権限差が UI/操作に反映
